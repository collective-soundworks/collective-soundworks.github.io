import{_ as a,o as e,c as n,O as l}from"./chunks/framework.b2c12034.js";const t="/assets/distributed-application.ec63aa91.png",o="/assets/distributed-state-management.d09470bb.png",p="/assets/wizard-create-player-confirm.30e4d539.png",c="/assets/global-server-log.8eafd9f0.png",r="/assets/global-client-log.a184f944.png",i="/assets/states-in-html.cfd64b16.png",d="/assets/create-controller-wizard.afe39dba.png",F="/assets/controller-1.8ae726c4.png",y="/assets/controller-2.a1db85de.png",h="/assets/controller-and-clients-1.db58d76e.png",u="/assets/controller-and-clients-2.51311d63.png",g="/assets/badly-defined-players.f2ea5e37.png",m="/assets/controller-player-final.ffc32479.png",A=JSON.parse('{"title":"Using the State Manager","description":"","frontmatter":{},"headers":[],"relativePath":"tutorials/state-manager.md","filePath":"tutorials/state-manager.md"}'),f={name:"tutorials/state-manager.md"};function E(b,s,w,v,D,B){return e(),n("div",null,s[0]||(s[0]=[l('<h1 id="using-the-state-manager" tabindex="-1">Using the State Manager <a class="header-anchor" href="#using-the-state-manager" aria-label="Permalink to &quot;Using the State Manager&quot;">​</a></h1><p>In this tutorial, we will dig into the distributed state management system proposed by <em>soundworks</em>. After a short introduction on the underlying concepts, we will see how to use shared states, and how this pattern can help you to implement remote control and monitoring in your applications. Along the way, we will see how the shared states simplify the development of distributed applications by abstracting the network communications and messages routing.</p><p>Along the way, we will discover a related library, <a href="https://ircam-ismm.github.io/sc-components/" target="_blank" rel="noreferrer">@ircam/sc-components</a>, to simply create usable (and hopefully elegant) graphical user interfaces.</p><h3 id="relevant-documentation" tabindex="-1">Relevant documentation <a class="header-anchor" href="#relevant-documentation" aria-label="Permalink to &quot;Relevant documentation&quot;">​</a></h3><ul><li><a href="https://soundworks.dev/soundworks/client.StateManager" target="_blank" rel="noreferrer">client.StateManager</a></li><li><a href="https://soundworks.dev/soundworks/client.SharedState" target="_blank" rel="noreferrer">client.SharedState</a></li><li><a href="https://soundworks.dev/soundworks/client.SharedStateCollection.html" target="_blank" rel="noreferrer">client.SharedStateCollection</a></li><li><a href="https://soundworks.dev/soundworks/server.StateManager" target="_blank" rel="noreferrer">server.StateManager</a></li><li><a href="https://soundworks.dev/soundworks/server.SharedState" target="_blank" rel="noreferrer">server.SharedState</a></li><li><a href="https://ircam-ismm.github.io/sc-components/" target="_blank" rel="noreferrer">@ircam/sc-components</a></li></ul><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>First of all, let&#39;s start with a bit of theory to understand the concepts and general logic behind the <em>soundworks</em>&#39; shared states.</p><h3 id="the-why" tabindex="-1">The &quot;Why&quot; <a class="header-anchor" href="#the-why" aria-label="Permalink to &quot;The &quot;Why&quot;&quot;">​</a></h3><p>Most of the time, we think of an application as &quot;something&quot; that runs on a computer with which a user can interact in some way. The idea of <em>distributed application</em> extends this to applications that run on several computers and where several users can interact at the same time. Or to say it in a more formal way:</p><blockquote><p><em>« A distributed system is a collection of autonomous computing elements that appears to its users as a single coherent system. »</em> Maarten van Steen, and Andrew S. Tanenbaum. “A Brief Introduction to Distributed Systems.” Computing 98, no. 10, October 2016.</p></blockquote><p><img src="'+t+'" alt="distributed-application"></p><p>Additionally, in creative contexts, it&#39;s important to have very simple ways to monitor and/or control the state of distant clients. This is true both during the development of the artwork / application, e.g. to tweak some synthesizer on distant machines from a central point (even in the studio, modifying some parameters on several machines can get cumbersome quite quickly), as well as during a performance, e.g. to control the general volume, to switch between two sections of the artwork, etc.</p><p>The <code>StateManager</code> and the <code>SharedState</code> abstractions proposed by <em>soundworks</em> provide a simple way to define and synchronize some sets of parameters that are of interest by multiple clients, while abstracting all the network communications involved.</p><h3 id="the-how" tabindex="-1">The &quot;How&quot; <a class="header-anchor" href="#the-how" aria-label="Permalink to &quot;The &quot;How&quot;&quot;">​</a></h3><p>From a more technical point of view, the distributed state management system proposed by <em>soundworks</em> is a circular data flow pattern (loosely inspired by the <a href="https://facebook.github.io/flux/docs/in-depth-overview" target="_blank" rel="noreferrer"><em>flux</em></a> pattern proposed by <em>Facebook</em>) adapted to the particular needs of real-time distributed applications.</p><p>To that end, the flow data is structured according to a circular path that is always synchronized with the server.</p><p><img src="'+o+`" alt="distributed-state-management"></p><p>As illustrated in the figure above, when an input (e.g. some user gesture) triggers a change in the state of a client (arrow 1, red), the data is automatically synchronized with a server-side representation of the state through WebSockets (arrow 2), which when done triggers the change in the rendering, be it audio or visual (arrow 3).</p><p>This simple pattern enables an important feature: any other node of the network can make a change on the same server-side representation of the state (arrow 1&#39;, blue), which will trigger 2 (red) and 3 (red) in a completely transparent way.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>In these tutorials, when we speak of a <strong><em>node of the network</em></strong>, we consider both the clients and the server.</p><p>Form the point of view of the distributed state management system, the server is indeed a <em>node</em> just as any client. However, its central role gives it particular abilities and features.</p></div><h2 id="scaffolding-the-application" tabindex="-1">Scaffolding the application <a class="header-anchor" href="#scaffolding-the-application" aria-label="Permalink to &quot;Scaffolding the application&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This section requires basic knowledge of the <em>soundworks</em> wizard, so please refer to the <a href="/tutorials/getting-started.html">getting started tutorial</a> if you didn&#39;t check it yet.</p></div><p>First thing first, let&#39;s generate a new empty application with the <code>@soundworks/create</code> wizard.</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">/path/to/working/directory</span></span>
<span class="line"><span style="color:#A6E22E;">npx</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">@soundworks/create@latest</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">state-manager</span></span></code></pre></div><p>When the wizard will ask you for the configuration of the default client:</p><ul><li>Name it <code>player</code></li><li>Select the <code>browser</code> target</li><li>Select the <code>default</code> template</li></ul><p><img src="`+p+`" alt="wizard-create-player-confirm"></p><p>Then open the new <code>state-manager</code> directory in your favorite editor and launch the application in development mode:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">state-manager</span></span>
<span class="line"><span style="color:#A6E22E;">npm</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">run</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">dev</span></span></code></pre></div><h2 id="declaring-schemas" tabindex="-1">Declaring schemas <a class="header-anchor" href="#declaring-schemas" aria-label="Permalink to &quot;Declaring schemas&quot;">​</a></h2><p>The <code>StateManager</code> component is configured with JavaScript objects that declare a set of attributes and their properties, which we call &quot;<em>schemas</em>&quot;. You can think of a <em>schema</em> as a kind of blueprint from which multiple <code>SharedState</code> instances can be created.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>If you are familiar with databases, you can think of it has the schema of a database table.</p><p>The syntax for declaring schemas is described <a href="https://soundworks.dev/soundworks/server.StateManager#~schema" target="_blank" rel="noreferrer">here</a>.</p></div><p>In this application we will declare two different schemas:</p><ul><li>A schema called <code>global</code> which we will use to store information accessible by all nodes of the network. This shared state will be unique across the whole application, i.e. it will be created by the server and all <code>player</code> clients will &quot;attach&quot; to it.</li><li>A schema called <code>player</code>, which we will use to describe the state of a single client of the application. All clients with the <code>player</code> role will create their own <code>SharedState</code> instance from this scheme.</li></ul><p>Let&#39;s then create the file <code>src/server/schemas/global.js</code>, and push the following code into it:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// src/server/schemas/global.js</span></span>
<span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">default</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// volume volume in dB [-60, 6]</span></span>
<span class="line"><span style="color:#F8F8F2;">  volume: {</span></span>
<span class="line"><span style="color:#F8F8F2;">    type: </span><span style="color:#E6DB74;">&#39;float&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    min: </span><span style="color:#F92672;">-</span><span style="color:#AE81FF;">60</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    max: </span><span style="color:#AE81FF;">6</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    default: </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  },</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// mute [true, false]</span></span>
<span class="line"><span style="color:#F8F8F2;">  mute: {</span></span>
<span class="line"><span style="color:#F8F8F2;">    type: </span><span style="color:#E6DB74;">&#39;boolean&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    default: </span><span style="color:#AE81FF;">false</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  },</span></span>
<span class="line"><span style="color:#F8F8F2;">};</span></span></code></pre></div><p>From this code we can see that this schema, and the derived <code>SharedState</code>, will allow us to control the <em>volume</em> of all clients as well as to <em>mute/unmute</em> them.</p><p>Second, let&#39;s create the file <code>src/server/schemas/player.js</code> containing the following code:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai"><code><span class="line"><span style="color:#88846F;">// src/server/schemas/player.js</span></span>
<span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">default</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  frequency: {</span></span>
<span class="line"><span style="color:#F8F8F2;">    type: </span><span style="color:#E6DB74;">&#39;float&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    min: </span><span style="color:#AE81FF;">50</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    max: </span><span style="color:#AE81FF;">1000</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    default: </span><span style="color:#AE81FF;">440</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  },</span></span>
<span class="line"><span style="color:#F8F8F2;">};</span></span></code></pre></div><p>This schema will allow us to create <code>SharedState</code>s on every client, which we will use to control the <em>frequency</em> of an oscillator.</p><p>From these two definitions, we can already foresee the structure of the audio graph that could be created by each client:</p><blockquote><p><code>[OscillatorNode] -&gt; [GainNode (mute)] -&gt; [GainNode (volume)] -&gt; [destination]</code></p></blockquote><ul><li>The <code>OscillatorNode</code> will be controlled by the states created from the <code>player</code> schema, each client being able to have different oscillator <em>frequency</em> values.</li><li>At contrary, the <code>GainNode</code>s (<em>mute</em> and <em>volume</em>) will be controlled globally for all clients by the common state created from <code>global</code> schema.</li></ul><p>To keep things focused on the distributed state management system, we won&#39;t actually create the audio graph in this tutorial, but this could be an interesting exercise to do on your own!</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Note that the <code>src/server/schemas</code> directory included in the application template is empty and not mandatory, i.e. schema declarations could potentially live anywhere in your code. It is just proposed as a good practice to keep things organized.</p></div><h2 id="registering-schemas" tabindex="-1">Registering schemas <a class="header-anchor" href="#registering-schemas" aria-label="Permalink to &quot;Registering schemas&quot;">​</a></h2><p>Let&#39;s first import the schemas declarations into the <code>src/server/index.js</code> file:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/server/index.js</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> { loadConfig } </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;../utils/load-config.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;../utils/catch-unhandled-errors.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> globalSchema </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;./schemas/global.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> playerSchema </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;./schemas/player.js&#39;</span><span style="color:#F8F8F2;">;</span></span></code></pre></div><p>Once done, we can register them into the <code>stateManager</code> instance of the <em>soundworks</em> <code>server</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/server/index.js</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> server </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">Server</span><span style="color:#F8F8F2;">(config);</span></span>
<span class="line"><span style="color:#88846F;">// configure the server for usage within this application template</span></span>
<span class="line"><span style="color:#F8F8F2;">server.</span><span style="color:#A6E22E;">useDefaultApplicationTemplate</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#88846F;">// register the schemas</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">server.stateManager.</span><span style="color:#A6E22E;">registerSchema</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">, globalSchema);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">server.stateManager.</span><span style="color:#A6E22E;">registerSchema</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">, playerSchema);</span></span></code></pre></div><p>Note that the <code>stateManager.registerSchema</code> method takes 2 arguments:</p><ul><li>A <em>user defined</em> name, here <code>&#39;global&#39;</code> and <code>&#39;player&#39;</code>.</li><li>A schema definition, here <code>globalSchema</code> and <code>playerSchema</code>.</li></ul><p>This signature allows to define simple user-friendly names for creating and attaching shared state, but also allows to register the same schema under different names in more advanced use cases.</p><p>Now that our schemas are registered into the <code>server.stateManager</code>, we can safely create new instances of <code>SharedState</code>s based on these schemas.</p><h2 id="creating-shared-states" tabindex="-1">Creating shared states <a class="header-anchor" href="#creating-shared-states" aria-label="Permalink to &quot;Creating shared states&quot;">​</a></h2><p>Let&#39;s first create our <code>global</code> shared state based on the schema declaration we defined in <code>src/server/schemas/global.js</code>.</p><p>As explained above, we want this shared state to be unique across the entire application so that all clients share the same values. This can be simply achieved:</p><ol><li>by <em>creating</em> the state on the server-side, i.e. the server is thus the <em>owner</em> of the state.</li><li>by <em>attaching</em> all our clients to this state, i.e. they have full access to the shared state values but they do not own it, which means that the state won&#39;t be deleted when they disconnect.</li></ol><p>While this distinction between <code>create</code> and <code>attach</code> can be a bit confusing at first this will get more clear writing the code.</p><p>Let&#39;s thus add following lines into the <code>src/server/index.js</code> to create our <code>global</code> <code>SharedState</code> instance from the schema we just registered with the name <code>&#39;global&#39;</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/server/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> server.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> server.stateManager.</span><span style="color:#A6E22E;">create</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(global.</span><span style="color:#A6E22E;">getValues</span><span style="color:#F8F8F2;">());</span></span></code></pre></div><p>In your <code>Terminal</code> window, you should now see the default values of the state displayed:</p><p><img src="`+c+`" alt="global-server-log"></p><p>Let &#39;s now <em>attach</em> all our <code>player</code> clients to the <code>global</code> state created by the server.</p><p>To that end, open the file <code>src/clients/player/index.js</code> and add the following lines of code:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(global.</span><span style="color:#A6E22E;">getValues</span><span style="color:#F8F8F2;">());</span></span></code></pre></div><p>Note that, instead of the method <code>stateManager.create</code> used on the server side, we use its counterpart <code>stateManager.attach</code> on the client side .</p><p>If you open the URL <a href="http://127.0.0.0:8000" target="_blank" rel="noreferrer">http://127.0.0.1:8000</a> in your browser of choice and open the JavaScript console, you should see the current values of the <code>global</code> state displayed in the console just as for the server:</p><p><img src="`+r+`" alt="global-client-log"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>To open the <em>JavaScript</em> console in your browser, you can press <code>Cmd + Alt + J</code> in <em>Chrome</em> or alternatively <code>Cmd + Alt + I</code> in <em>Firefox</em>, then select the <code>Console</code> tab.</p></div><p>While we are on the client-side code of our &quot;player&quot; clients, let&#39;s create the <code>player</code> shared state for each of them. To that end, add the following line of code in the <code>src/clients/player/index.js</code> file:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> player </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">create</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">);</span></span></code></pre></div><p>Here, you can see side-by-side the <code>stateManager.create</code> and <code>stateManager.attach</code> methods and how they relate:</p><ul><li><code>stateManager.create</code> creates a new instance of a shared state that is owned by the node (clients or server).</li><li><code>stateManager.attach</code> attach to an existing shared state instance created and owned by another node.</li></ul><h2 id="display-the-states-values" tabindex="-1">Display the states values <a class="header-anchor" href="#display-the-states-values" aria-label="Permalink to &quot;Display the states values&quot;">​</a></h2><p>Now that our shared states are setup, let&#39;s continue on our client-side code to display the current values of the different shared states and update the screen when their values change.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>In these series, all HTML rendering will be achieved by using the <a href="https://lit.dev/" target="_blank" rel="noreferrer">Lit</a> library proposed by <em>Google</em> and the <a href="https://ircam-ismm.github.io/sc-components/" target="_blank" rel="noreferrer">@ircam/sc-components</a> library. Both libraries are installed by default when you create a new application using the soundworks wizard.</p></div><p>Let&#39;s first modify the <code>renderApp</code> provided by the &quot;player&quot; boilerplate code to display the values of our two states:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> player </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">create</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">render</span><span style="color:#F8F8F2;">(</span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\`</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;div class=&quot;simple-layout&quot;&gt;</span></span>
<span class="line diff remove"><span style="color:#E6DB74;">      &lt;p&gt;Hello </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.config.app.name</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">!&lt;/p&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;h2&gt;Global&lt;/h2&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;ul&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">        &lt;li&gt;volume: </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;volume&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&lt;/li&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">        &lt;li&gt;mute: </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;mute&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&lt;/li&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;/ul&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;h2&gt;Player&lt;/h2&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;ul&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">        &lt;li&gt;frequency: </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">player.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;frequency&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&lt;/li&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;/ul&gt; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74;">      &lt;sw-credits .infos=&quot;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.config.app</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&quot;&gt;&lt;/sw-credits&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">  \`</span><span style="color:#F8F8F2;">, $container);</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">();</span></span></code></pre></div><p>If you refresh your web page (<code>Cmd + Shift + R</code>), you should now see the following:</p><p><img src="`+i+'" alt="states-in-html"></p><p>So far so good, we have all our states set up and some display of their values. It&#39;s indeed only graphical and we won&#39;t go into the audio details in this tutorial to keep things focused on the shared states, but the general idea would be exactly the same with some audio rendering.</p><p>However, what we miss now is a way to change the values of the states. While we could implement it directly in our <code>player</code> clients, we will go a bit deeper with the <code>StateManager</code> and create a new client dedicated to this task.</p><h2 id="remote-control-and-monitoring" tabindex="-1">Remote control and monitoring <a class="header-anchor" href="#remote-control-and-monitoring" aria-label="Permalink to &quot;Remote control and monitoring&quot;">​</a></h2><p>In this section we will implement a second type of client, we will call <code>controller</code>, dedicated to control and monitor the general state of the application.</p><h3 id="scaffolding-the-controller-client" tabindex="-1">Scaffolding the <em>controller</em> client <a class="header-anchor" href="#scaffolding-the-controller-client" aria-label="Permalink to &quot;Scaffolding the _controller_ client&quot;">​</a></h3><p>Let&#39;s use the soundworks wizard to configure our new client and to create all the boilerplate code.</p><p>Go to the <code>Terminal</code>, shutdown the server (<code>Ctrl + C</code>) and enter the following command:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#A6E22E;">npx</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">soundworks</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">--create-client</span></span></code></pre></div><p>Just as when you created the application at the beginning of the tutorial, the soundworks wizard will ask you some questions to configure the client:</p><ol><li>Name this new client <code>controller</code></li><li>Select the <code>browser</code> target</li><li>But this time select the <code>controller</code> template</li></ol><p>Additionally, the wizard will ask you if you want to use this client as the default one (meaning it will be accessible at the root of your website), choose <code>no</code> and confirm.</p><p><img src="'+d+`" alt="create-controller-wizard"></p><p>In your editor you can see that new directory <code>src/clients/controller</code> has been created by the wizard. This is where we will implement the logic for our &quot;controller&quot; client.</p><p>Now that everything is set up, we can go back to the implementation of our <code>controller</code> client. Let&#39;s then first restart our development server:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">npm run dev</span></span></code></pre></div><p>and open the page <a href="http://127.0.0.1:8000/controller" target="_blank" rel="noreferrer">http://127.0.0.1:8000/controller</a></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Note that the <code>/controller</code> part of the URL is automatically created by soundworks according to the names of the clients.</p></div><h3 id="binding-the-global-state" tabindex="-1">Binding the <code>global</code> state <a class="header-anchor" href="#binding-the-global-state" aria-label="Permalink to &quot;Binding the \`global\` state&quot;">​</a></h3><p>Let&#39;s start with creating the controls for the <code>global</code> shared state. Open the <code>src/clients/controller/index.js</code> file and add the following code to import some high-level components provided by the <a href="https://ircam-ismm.github.io/sc-components/" target="_blank" rel="noreferrer">@ircam/sc-components</a> library:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/controller/index.js</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/helpers/polyfills.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> { Client } </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/core/client.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> launcher </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/helpers/launcher.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> { html, render } </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;lit&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@ircam/sc-components/sc-number.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@ircam/sc-components/sc-slider.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@ircam/sc-components/sc-text.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@ircam/sc-components/sc-toggle.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;../components/sw-audit.js&#39;</span><span style="color:#F8F8F2;">;</span></span></code></pre></div><p>Importing these files will register new HTML elements that we can now use in our HTML templates: a text element to display parameter names, a slider to control the volume, a toggle button to control the mute parameter, and a number box to control the players&#39; frequencies.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Such HTML components are called Web Components, see <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components" target="_blank" rel="noreferrer">https://developer.mozilla.org/en-US/docs/Web/Web_Components</a> for more information on this specific subject.</p></div><p>Then, such as for the <code>player</code>, let&#39;s attach to the global state and create a component that displays its values:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/controller/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line diff add"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">render</span><span style="color:#F8F8F2;">(</span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\`</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;div class=&quot;controller-layout&quot;&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;header&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">        &lt;h1&gt;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.config.app.name</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> | </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.role</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&lt;/h1&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">        &lt;sw-audit .client=&quot;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&quot;&gt;&lt;/sw-audit&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;/header&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;section&gt;</span></span>
<span class="line diff remove"><span style="color:#E6DB74;">        &lt;p&gt;Hello </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.config.app.name</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">!&lt;/p&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">        &lt;div&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;h2&gt;Global&lt;/h2&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;div style=&quot;padding-bottom: 4px;&quot;&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &lt;sc-text readonly value=&quot;volume (dB)&quot;&gt;&lt;/sc-text&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &lt;sc-slider </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              min=&quot;-60&quot; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              max=&quot;6&quot; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              value=</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;volume&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &gt;&lt;/sc-slider&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;/div&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;div style=&quot;padding-bottom: 4px;&quot;&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &lt;sc-text readonly value=&quot;mute&quot;&gt;&lt;/sc-text&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &lt;sc-toggle </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              ?active=</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;mute&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &gt;&lt;/sc-toggle&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;/div&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">        &lt;/div&gt; </span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;/section&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">  \`</span><span style="color:#F8F8F2;">, $container);</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">();</span></span></code></pre></div><p>If you refresh your <code>controller</code> page, you should now see the following interface with the <code>global</code> shared state default values correctly displayed (see usage of the <a href="https://soundworks.dev/soundworks/client.SharedState.html#get" target="_blank" rel="noreferrer"><code>global.get</code></a> method):</p><p><img src="`+F+`" alt="controller-1"></p><p>However, the binding between the state and the interface is still missing: interacting the interface (e.g. moving the slider or clicking the toggle) does not yet update the shared state values. To fix that, we simply need to use the <a href="https://soundworks.dev/soundworks/client.SharedState.html#set" target="_blank" rel="noreferrer"><code>global.set</code></a> method and add the following lines of code:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/controller/index.js</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">render</span><span style="color:#F8F8F2;">(</span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\`</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;div class=&quot;controller-layout&quot;&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;header&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">        &lt;h1&gt;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.config.app.name</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> | </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client.role</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&lt;/h1&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">        &lt;sw-audit .client=&quot;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">client</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&quot;&gt;&lt;/sw-audit&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;/header&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;section&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">        &lt;div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">          &lt;h2&gt;Global&lt;/h2&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">          &lt;div style=&quot;padding-bottom: 4px;&quot;&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">            &lt;sc-text readonly value=&quot;volume (dB)&quot;&gt;&lt;/sc-text&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">            &lt;sc-slider</span></span>
<span class="line"><span style="color:#E6DB74;">              min=&quot;-60&quot;</span></span>
<span class="line"><span style="color:#E6DB74;">              max=&quot;6&quot;</span></span>
<span class="line"><span style="color:#E6DB74;">              value=</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;volume&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span></span>
<span class="line diff add"><span style="color:#E6DB74;">              @input=</span><span style="color:#F92672;">\${</span><span style="color:#FD971F;font-style:italic;">e</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> global.</span><span style="color:#A6E22E;">set</span><span style="color:#F8F8F2;">({ volume: e.detail.value })</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line"><span style="color:#E6DB74;">            &gt;&lt;/sc-slider&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">          &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">          &lt;div style=&quot;padding-bottom: 4px;&quot;&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">            &lt;sc-text readonly value=&quot;mute&quot;&gt;&lt;/sc-text&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">            &lt;sc-toggle</span></span>
<span class="line"><span style="color:#E6DB74;">              ?active=</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;mute&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span></span>
<span class="line diff add"><span style="color:#E6DB74;">              @change=</span><span style="color:#F92672;">\${</span><span style="color:#FD971F;font-style:italic;">e</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> global.</span><span style="color:#A6E22E;">set</span><span style="color:#F8F8F2;">({ mute: e.detail.value })</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line"><span style="color:#E6DB74;">            &gt;&lt;/sc-toggle&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">          &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">        &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;/section&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">  \`</span><span style="color:#F8F8F2;">, $container);</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div><p>Finally, we just need to tell your interface to re-render itself when the <code>global</code> is updated, which can be achieved by using the <a href="https://soundworks.dev/soundworks/client.SharedState.html#onUpdate" target="_blank" rel="noreferrer"><code>global.onUpdate</code></a> method:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// ...</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">// update interface when the shared state values are updated</span></span>
<span class="line diff add"><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">onUpdate</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">()); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">();</span></span></code></pre></div><p>Now, if you open <a href="http://127.0.0.1:8000/controller?emulate=2" target="_blank" rel="noreferrer">http://127.0.0.1:8000/controller?emulate=2</a> to emulate two <code>controller</code> clients side by side (see the <code>?emulate=2</code> at the end of the URL), you should see that both interfaces are fully synchronized through the <code>global</code> shared state.</p><p><img src="`+y+`" alt="controller-2"></p><p>Now that our &quot;controller&quot; is ready, let&#39;s go back to our <code>player</code> clients to implement the same logic to update the screen when the shared states are updated. So let&#39;s re-open the <code>src/clients/player/index.js</code> file and add the following lines of code:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> player </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">create</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// ...</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line diff add"><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">onUpdate</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">()); </span></span>
<span class="line diff add"><span style="color:#F8F8F2;">player.</span><span style="color:#A6E22E;">onUpdate</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">()); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">();</span></span></code></pre></div><p>With these two simple lines of code, all the clients are now automatically updated anytime a shared-state parameter is modified. To see this in action, open two browser windows side by side and open some controller(s) in one of them <a href="http://127.0.0.1:8000/controller?emulate=2" target="_blank" rel="noreferrer">http://127.0.0.1:8000/controller?emulate=2</a> and some players in the other one <a href="http://127.0.0.1:8000/?emulate=2" target="_blank" rel="noreferrer">http://127.0.0.1:8000/?emulate=2</a>.</p><p><img src="`+h+`" alt="controller-and-clients-1"></p><h3 id="observing-and-controlling-collections-of-states" tabindex="-1">Observing and controlling collections of states <a class="header-anchor" href="#observing-and-controlling-collections-of-states" aria-label="Permalink to &quot;Observing and controlling collections of states&quot;">​</a></h3><p>The final thing we would like to do, would be to be able to control the frequency of each player from our <code>controller</code> clients. To that end, the controller needs to be able to track the creation (and deletion) of all <code>player</code> states in the distributed application. Fortunately, the <code>StateManager</code> gives you access to such functionality.</p><p>Let&#39;s thus create a new <a href="https://soundworks.dev/soundworks/client.SharedStateCollection.html" target="_blank" rel="noreferrer"><code>SharedStateCollection</code></a> of players and make sure the interface is updated each time a &quot;player&quot; state is created (i.e. when a client connects to the application), is deleted (i.e. when a client disconnects from the application), or when a state is updated:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/controller/index.js</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"><span style="color:#88846F;">// Create a new collection that contains all the player states</span></span>
<span class="line diff add highlighted"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> players </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">getCollection</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">); </span></span>
<span class="line highlighted"><wbr></span>
<span class="line highlighted"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// ...</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">}</span></span>
<span class="line highlighted"><wbr></span>
<span class="line highlighted"><span style="color:#88846F;">// update interface when the shared state values are updated</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">global.</span><span style="color:#A6E22E;">onUpdate</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">());</span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">players.</span><span style="color:#A6E22E;">onAttach</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">()); </span><span style="color:#88846F;">// when a state is created </span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">players.</span><span style="color:#A6E22E;">onDetach</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">()); </span><span style="color:#88846F;">// when a state is deleted </span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">players.</span><span style="color:#A6E22E;">onUpdate</span><span style="color:#F8F8F2;">(() </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">()); </span><span style="color:#88846F;">// when a state is updated </span></span></code></pre></div><p>Finally, let&#39;s just update our HTML template to display the frequency control for all <code>player</code> shared states:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#A6E22E;">render</span><span style="color:#F8F8F2;">(</span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\`</span></span>
<span class="line"><span style="color:#E6DB74;">  &lt;header&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">    // ...</span></span>
<span class="line"><span style="color:#E6DB74;">  &lt;/header&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">  &lt;section&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;h2&gt;Global&lt;/h2&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      // ...</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;/div&gt;</span></span>
<span class="line diff add"><span style="color:#E6DB74;">    &lt;div&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;h2&gt;Players&lt;/h2&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">players.</span><span style="color:#A6E22E;">map</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">player</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> { </span></span>
<span class="line diff add"><span style="color:#F8F8F2;">        </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\` </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;div&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &lt;sc-text&gt;frequency&lt;/sc-text&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &lt;sc-number </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              min=&quot;50&quot; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              max=&quot;1000&quot; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              value=</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">player.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;frequency&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line diff add"><span style="color:#E6DB74;">              @input=</span><span style="color:#F92672;">\${</span><span style="color:#FD971F;font-style:italic;">e</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> player.</span><span style="color:#A6E22E;">set</span><span style="color:#F8F8F2;">({ frequency: e.detail.value })</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line diff add"><span style="color:#E6DB74;">            &gt;&lt;/sc-number&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">          &lt;/div&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">        \`</span><span style="color:#F8F8F2;"> </span></span>
<span class="line diff add"><span style="color:#F8F8F2;">      })</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> </span></span>
<span class="line diff add"><span style="color:#E6DB74;">    &lt;/div&gt; </span></span>
<span class="line"><span style="color:#E6DB74;">  &lt;/section&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">\`</span><span style="color:#F8F8F2;">, $container);</span></span></code></pre></div><p>Now if you open two browser windows and launch a controller <a href="http://127.0.0.1:8000/controller" target="_blank" rel="noreferrer">http://127.0.0.1:8000/controller</a> and a player <a href="http://127.0.0.1:8000/" target="_blank" rel="noreferrer">http://127.0.0.1:8000/</a>, you will see that you can control the frequency of the player from the controller.</p><p><img src="`+u+'" alt="controller-and-clients-2"></p><p>However, there is still an issue with our interface: if we emulate several player clients, e.g. <a href="http://127.0.0.1:8000/?emulate=6" target="_blank" rel="noreferrer">http://127.0.0.1:8000/?emulate=6</a>, we can see that we have no way to know which control corresponds to which player:</p><p><img src="'+g+`" alt="badly-defined-players"></p><p>Let&#39;s review our code a bit to tackle this issue.</p><h3 id="using-the-client-id-to-enhance-the-control-interface" tabindex="-1">Using the client id to enhance the control interface <a class="header-anchor" href="#using-the-client-id-to-enhance-the-control-interface" aria-label="Permalink to &quot;Using the client id to enhance the control interface&quot;">​</a></h3><p>To fix this problem, let&#39;s just use the id that is automatically given by <em>soundworks</em> to each client when it connects to share it within the <code>player</code> state.</p><p>So first, let&#39;s add a new parameter called <code>id</code> of type <code>integer</code> to our <code>player</code> schema to store this value:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-highlighted-lines has-diff"><code><span class="line"><span style="color:#88846F;">// src/server/schemas/player.js</span></span>
<span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">default</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">  id: { </span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">    type: </span><span style="color:#E6DB74;">&#39;integer&#39;</span><span style="color:#F8F8F2;">, </span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">    default: </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">  }, </span></span>
<span class="line"><span style="color:#F8F8F2;">  frequency: {</span></span>
<span class="line"><span style="color:#F8F8F2;">    type: </span><span style="color:#E6DB74;">&#39;float&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    min: </span><span style="color:#AE81FF;">50</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    max: </span><span style="color:#AE81FF;">1000</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    default: </span><span style="color:#AE81FF;">440</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  },</span></span>
<span class="line"><span style="color:#F8F8F2;">};</span></span></code></pre></div><p>Second, let&#39;s review our <code>player</code> client code to:</p><ol><li>pass the client id to the shared state when it is created by the client</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> global </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">attach</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;global&#39;</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#88846F;">// create the player state with the client id</span></span>
<span class="line diff remove"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> player </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">create</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">) </span></span>
<span class="line diff add"><span style="color:#66D9EF;font-style:italic;">const</span><span style="color:#F8F8F2;"> player </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.stateManager.</span><span style="color:#A6E22E;">create</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;player&#39;</span><span style="color:#F8F8F2;">, { id: client.id }); </span></span></code></pre></div><ol start="2"><li>and display the <code>client.id</code> in the player interface:</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">renderApp</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#A6E22E;">render</span><span style="color:#F8F8F2;">(</span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\`</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;div class=&quot;simple-layout&quot;&gt;</span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;h1&gt;Player </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">player.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;id&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&lt;/h1&gt; </span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;h2&gt;Global&lt;/h2&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">      // ...</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">  \`</span><span style="color:#F8F8F2;">, $container);</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div><p>Finally, let&#39;s just display this information in the controller interface:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki monokai has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/controller/index.js</span></span>
<span class="line"><span style="color:#F8F8F2;">\${players.</span><span style="color:#A6E22E;">map</span><span style="color:#F8F8F2;">(</span><span style="color:#FD971F;font-style:italic;">player</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F92672;">return</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">html</span><span style="color:#E6DB74;">\`</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;div&gt;</span></span>
<span class="line diff remove"><span style="color:#E6DB74;">      &lt;sc-text&gt;frequency&lt;/sc-text&gt; </span></span>
<span class="line diff add"><span style="color:#E6DB74;">      &lt;sc-text&gt;player: </span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">player.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;id&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;"> - frequency&lt;/sc-text&gt; </span></span>
<span class="line"><span style="color:#E6DB74;">      &lt;sc-number</span></span>
<span class="line"><span style="color:#E6DB74;">        min=&quot;50&quot;</span></span>
<span class="line"><span style="color:#E6DB74;">        max=&quot;1000&quot;</span></span>
<span class="line"><span style="color:#E6DB74;">        value=</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">player.</span><span style="color:#A6E22E;">get</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;frequency&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F92672;">}</span></span>
<span class="line"><span style="color:#E6DB74;">        @input=</span><span style="color:#F92672;">\${</span><span style="color:#FD971F;font-style:italic;">e</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;font-style:italic;">=&gt;</span><span style="color:#F8F8F2;"> player.</span><span style="color:#A6E22E;">set</span><span style="color:#F8F8F2;">({ frequency: e.detail.value })</span><span style="color:#F92672;">}</span></span>
<span class="line"><span style="color:#E6DB74;">      &gt;&lt;/sc-number&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">    &lt;/div&gt;</span></span>
<span class="line"><span style="color:#E6DB74;">  \`</span></span>
<span class="line"><span style="color:#F8F8F2;">})}</span></span></code></pre></div><p>Now, if you open a controller (<a href="http://127.0.0.1:8000/controller" target="_blank" rel="noreferrer">http://127.0.0.1:8000/controller</a>) and several players (<a href="http://127.0.0.1:8000/?emulate=3" target="_blank" rel="noreferrer">http://127.0.0.1:8000/?emulate=3</a>) side by side, you should have a more useful interface:</p><p><img src="`+m+'" alt="controller-player-final"></p><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>In this tutorial, you learned how to use the <em>soundworks</em> distributed state management system which we think is one of its most powerful and versatile feature.</p><p>You have seen how to create global states that are common to all clients of the application, how to use them to describe the state of each client and how use them to implement remote control and monitoring interfaces using state collections. Along the way, you have seen how to use the <em>soundworks</em> wizard within your application (i.e. <code>npx soundworks</code>).</p><p>In the next tutorial, we will see how to extend the possibilities of <em>soundworks</em> with plugins. For this first dive into plugins we will use the <code>@soundworks/plugin-platform-init</code> plugin that is meant to simplify some redundant and cumbersome tasks such as resuming the audio context, etc.</p>',145)]))}const q=a(f,[["render",E]]);export{A as __pageData,q as default};
