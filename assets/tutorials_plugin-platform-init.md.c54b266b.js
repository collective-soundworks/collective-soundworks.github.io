import{_ as s,c as e,o as n,a}from"./app.0c9f8bbd.js";const o="/assets/wizard-1.31b229d4.png",l="/assets/wizard-2.bebc51d1.png",t="/assets/wizard-3.883b2723.png",p="/assets/homepage.59c52cb9.png",i="/assets/homepage-multiple.dfd6ed6a.png",r="/assets/homepage-custom.6f5d06bf.png",k=JSON.parse('{"title":"Using Plugins 1 - The platform-init Plugin","description":"","frontmatter":{},"headers":[{"level":3,"title":"Relevant documentation","slug":"relevant-documentation","link":"#relevant-documentation","children":[]},{"level":2,"title":"Installing the plugin","slug":"installing-the-plugin","link":"#installing-the-plugin","children":[]},{"level":2,"title":"Registering the plugin into soundworks","slug":"registering-the-plugin-into-soundworks","link":"#registering-the-plugin-into-soundworks","children":[{"level":3,"title":"Server-side registration","slug":"server-side-registration","link":"#server-side-registration","children":[]},{"level":3,"title":"Client-side registration","slug":"client-side-registration","link":"#client-side-registration","children":[]}]},{"level":2,"title":"Resuming an AudioContext","slug":"resuming-an-audiocontext","link":"#resuming-an-audiocontext","children":[]},{"level":2,"title":"Notes on the @soundworks/helpers default views","slug":"notes-on-the-soundworks-helpers-default-views","link":"#notes-on-the-soundworks-helpers-default-views","children":[]},{"level":2,"title":"Conclusion","slug":"conclusion","link":"#conclusion","children":[]}],"relativePath":"tutorials/plugin-platform-init.md"}'),c={name:"tutorials/plugin-platform-init.md"},d=a(`<h1 id="using-plugins-1-the-platform-init-plugin" tabindex="-1">Using Plugins 1 - The <em>platform-init</em> Plugin <a class="header-anchor" href="#using-plugins-1-the-platform-init-plugin" aria-hidden="true">#</a></h1><p>In this first tutorial on <em>soundworks</em> plugins, we will learn why and how to use the <em>platform-init</em> plugin, which aims to simplify the use of certain features (such as the Web Audio API) that require a user gesture to be properly initialized.</p><p>The tutorial requires basic knowledge of the <code>soundworks</code> wizard, so please refer to the <a href="/tutorials/getting-started.html">getting started tutorial</a> if you didn&#39;t check it yet.</p><h3 id="relevant-documentation" tabindex="-1">Relevant documentation <a class="header-anchor" href="#relevant-documentation" aria-hidden="true">#</a></h3><ul><li><a href="https://soundworks.dev/soundworks/client.PluginManager" target="_blank" rel="noreferrer">client.PluginManager</a></li><li><a href="https://soundworks.dev/soundworks/server.PluginManager" target="_blank" rel="noreferrer">server.PluginManager</a></li><li><a href="https://github.com/collective-soundworks/soundworks-plugin-platform-init" target="_blank" rel="noreferrer">@soundworks/plugin-platform-init</a></li></ul><h2 id="installing-the-plugin" tabindex="-1">Installing the plugin <a class="header-anchor" href="#installing-the-plugin" aria-hidden="true">#</a></h2><p>First thing first, let&#39;s generate a new empty application with the <code>@soundworks/create</code> wizard. When the wizard will ask you for the name of the default client, just call it <code>player</code> (with the <code>browser</code> target and the <code>default</code> template) so that the rest of the tutorial will be more simple to follow:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki"><code><span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> /path/to/working/directory</span></span>
<span class="line"><span style="color:#F8F8F2;">npx @soundworks/create@latest plugin-platform-init</span></span>
<span class="line"></span></code></pre></div><p>Once done, go to the directory and launch the <code>soundworks</code> wizard again to install the plugin:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki"><code><span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;">  plugin-platform-init</span></span>
<span class="line"><span style="color:#F8F8F2;">npx soundworks</span></span>
<span class="line"></span></code></pre></div><p>Then select the <code>install / uninstall soundworks plugins</code> entry:</p><p><img src="`+o+'" alt="wizard-1"></p><p>Select the <code>@soundworks/plugin-platform-init</code> using the space bar:</p><p><img src="'+l+'" alt="wizard-2"></p><p>And confirm:</p><p><img src="'+t+`" alt="wizard-3"></p><p>After the installation, you can exit the wizard by pressing <code>Ctrl+C</code> or by selecting the <code>\u2192 exit</code> entry.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Note that the wizard asks you if you want to install plugins when creating the application. We just followed the long path to show you how to use the wizard within the application.</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>If you are confortable with <code>npm</code> (or <code>yarn</code> or whatever new fancy tool) and you don&#39;t want to use the wizard for some reason, you can also:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki"><code><span class="line"><span style="color:#F8F8F2;">npm install --save @soundworks/plugin-platform-init</span></span>
<span class="line"></span></code></pre></div><p>In this case, the wizard is just there to help you if you don&#39;t remember the name of the package and don&#39;t want to search for it.</p></div><p>If you open the <code>package.json</code> file, that among other things allows you to keep a list the dependencies of your project, you should see the <code>@soundworks/plugin-platform-init</code> appearing under the <code>dependencies</code> key:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// package.json</span></span>
<span class="line"><span style="color:#E6DB74;">&quot;dependencies&quot;</span><span style="color:#F8F8F2;">: {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;">&quot;@soundworks/core&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;^4.0.0-alpha.0&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;">&quot;@soundworks/helpers&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;^1.0.0-alpha.2&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;">&quot;@soundworks/plugin-platform-init&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;^1.0.0-alpha.1&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;">&quot;json5&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;^2.2.2&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#66D9EF;">&quot;lit&quot;</span><span style="color:#F8F8F2;">: </span><span style="color:#CFCFC2;">&quot;^2.2.2&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">},</span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Note that the actual version numbers might change compared the one listed above, as new versions of the core library and of the plugins will be released in the future.</p></div><p>If for some reason you need to re-install the application dependencies (i.e. <code>npm install</code>) the plugin will be re-installed as well.</p><h2 id="registering-the-plugin-into-soundworks" tabindex="-1">Registering the plugin into <em>soundworks</em> <a class="header-anchor" href="#registering-the-plugin-into-soundworks" aria-hidden="true">#</a></h2><p>Now that the plugin is installed as a dependency of our application, let&#39;s write the code to register the plugin into the application.</p><p>Note that by design, all <em>soundworks</em> plugins always come with both a server-side component and a client-side component. So, you will always have to register the plugin on both side of your application.</p><h3 id="server-side-registration" tabindex="-1">Server-side registration <a class="header-anchor" href="#server-side-registration" aria-hidden="true">#</a></h3><p>Let&#39;s start with the server-side part and write the following code in the <code>src/server/index.js</code> file. First let&#39;s import the server-side part of the plugin on top of the file:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/server/index.js</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/helpers/polyfills.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> { Server } </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/core/server.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#88846F;">// import the server-side part of the \`platform-init\` plugin</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> pluginPlatformInit </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/plugin-platform-init/server.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span></code></pre></div><p>Then register it into the <code>server.pluginManager</code> component:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/server/index.js</span></span>
<span class="line"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> server </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">Server</span><span style="color:#F8F8F2;">(config);</span></span>
<span class="line"><span style="color:#F8F8F2;">server.</span><span style="color:#A6E22E;">useDefaultApplicationTemplate</span><span style="color:#F8F8F2;">();</span></span>
<span class="line highlighted"><span style="color:#88846F;">// register the plugin into the soundworks&#39; plugin manager</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">server.pluginManager.</span><span style="color:#A6E22E;">register</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;platform-init&#39;</span><span style="color:#F8F8F2;">, pluginPlatformInit);</span></span>
<span class="line"></span></code></pre></div><p>The <a href="https://soundworks.dev/soundworks/server.PluginManager#register" target="_blank" rel="noreferrer"><code>pluginManager.register</code></a> method takes at least 2 arguments:</p><ul><li>A user defined <code>id</code> (here <code>platform-init</code>) that is used as an internal identifier to retrieve the plugin instance, and allows to register several time the same plugin under different ids in advanced use-cases.</li><li>A factory function (i.e. <code>pluginPlatformInit</code>) automatically executed by <em>soundworks</em>, that returns the actual plugin instance.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>A <strong><em>factory function</em></strong> is common design pattern that allows for creating a full-featured object from a function call. You can check this <a href="https://www.javascripttutorial.net/javascript-factory-functions/" target="_blank" rel="noreferrer">tutorial </a> for more information.</p><p>In the future, we will provide a full tutorial dedicated to the creation of <code>soundworks</code> plugins.</p></div><p>That&#39;s all for the server-side, so let&#39;s now install the plugin on the client-side.</p><h3 id="client-side-registration" tabindex="-1">Client-side registration <a class="header-anchor" href="#client-side-registration" aria-hidden="true">#</a></h3><p>Let&#39;s open the <code>src/clients/player/index.js</code> and, as for the server-side, import the client-side part of the <em>platform-init</em> plugin:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> { Client } </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/core/client.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> launcher </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/helpers/launcher.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#88846F;">// import the client-side part of the \`platform-init\` plugin</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> pluginPlatformInit </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/plugin-platform-init/client.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Notice the small difference between the server-side and client-side imports, which is a convention that all <em>soundworks</em> plugins will follow:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// server-side</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> pluginPlatformInit </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/plugin-platform-init/server.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#88846F;">// client-side</span></span>
<span class="line highlighted"><span style="color:#F92672;">import</span><span style="color:#F8F8F2;"> pluginPlatformInit </span><span style="color:#F92672;">from</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">&#39;@soundworks/plugin-platform-init/client.js&#39;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span></code></pre></div></div><p>Now that our plugin is imported, let&#39;s also register it into the <a href="https://soundworks.dev/soundworks/client.PluginManager" target="_blank" rel="noreferrer"><code>client.PluginManager</code></a>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> client </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">Client</span><span style="color:#F8F8F2;">(config);</span></span>
<span class="line highlighted"><span style="color:#88846F;">// register the plugin into the soundworks&#39; plugin manager</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">client.pluginManager.</span><span style="color:#A6E22E;">register</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;platform-init&#39;</span><span style="color:#F8F8F2;">, pluginPlatformInit);</span></span>
<span class="line"></span></code></pre></div><p>As for the server-side, we passed 2 arguments to the <a href="https://soundworks.dev/soundworks/client.PluginManager#register" target="_blank" rel="noreferrer"><code>client.PluginManager#register</code></a> method: the plugin user-defined <code>id</code> and the plugin factory function. Note that the user-defined <code>id</code> is the same on both server-side and client-side, which allows <em>soundworks</em> to automatically match and associate the two components.</p><p>If you start the server now (<code>npm run dev</code>) and go to <a href="http://127.0.0.1:8000" target="_blank" rel="noreferrer">http://127.0.0.1:8000</a>, you should see the splashscreen that requires a user gesture (i.e. a &quot;click&quot; event) and that is automatically shown due to the fact that the <em>platform-init</em> plugin is registered into <em>soundworks</em>:</p><p><img src="`+p+`" alt="homepage"></p><h2 id="resuming-an-audiocontext" tabindex="-1">Resuming an <code>AudioContext</code> <a class="header-anchor" href="#resuming-an-audiocontext" aria-hidden="true">#</a></h2><p>So far, so good but what we did until now is just to add a slashscreen asking for a click that does nothing particular... Or, as we said in the beginning of the tutorial, the whole aim of the plugin is to simplify the initialization of features, such as the Web Audio API <code>AudioContext</code>, that require a user-gesture in order to be properly launched. So let&#39;s do that.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>An active user gesture is required by browser to access certain advanced features such as Web Audio API, microphone or camera. This is a way to protect end-users against intrusive ads and/or for obvious privacy reasons.</p></div><p>So first, let&#39;s first create an new <code>audioContext</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> config </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> window.SOUNDWORKS_CONFIG;</span></span>
<span class="line highlighted"><span style="color:#88846F;">// create a global audio context</span></span>
<span class="line highlighted"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> audioContext </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AudioContext</span><span style="color:#F8F8F2;">();</span></span>
<span class="line"></span></code></pre></div><p>And pass it as third argument to the <code>pluginManager.register</code> method:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines has-diff"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> client </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">Client</span><span style="color:#F8F8F2;">(config);</span></span>
<span class="line"><span style="color:#88846F;">// register the plugin into the soundworks&#39; plugin manager, and pass it the audioContext</span></span>
<span class="line diff remove highlighted"><span style="color:#F8F8F2;">client.pluginManager.</span><span style="color:#A6E22E;">register</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;platform-init&#39;</span><span style="color:#F8F8F2;">, pluginPlatformInit);  </span></span>
<span class="line diff add highlighted"><span style="color:#F8F8F2;">client.pluginManager.</span><span style="color:#A6E22E;">register</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">&#39;platform-init&#39;</span><span style="color:#F8F8F2;">, pluginPlatformInit, { audioContext });  </span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>By default, the <em>platform-init</em> plugin simplifies access to several features, such as motion sensors, microphone and camera. Refer to the <a href="https://github.com/collective-soundworks/soundworks-plugin-platform-init" target="_blank" rel="noreferrer">plugin documentation</a> for more information.</p></div><p>Finally, let&#39;s create some welcoming sound that will show us that everything works well and that our <code>audioContext</code> is properly resumed:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki has-highlighted-lines"><code><span class="line"><span style="color:#88846F;">// src/clients/player/index.js</span></span>
<span class="line"><span style="color:#F8F8F2;">launcher.</span><span style="color:#A6E22E;">register</span><span style="color:#F8F8F2;">(client, { initScreensContainer: $container });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">// launch application</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">\`&gt; before start - audioContext is &quot;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">audioContext.state</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&quot;\`</span><span style="color:#F8F8F2;">);</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> client.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">();</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">console.</span><span style="color:#A6E22E;">log</span><span style="color:#F8F8F2;">(</span><span style="color:#E6DB74;">\`&gt; after start - audioContext is &quot;</span><span style="color:#F92672;">\${</span><span style="color:#F8F8F2;">audioContext.state</span><span style="color:#F92672;">}</span><span style="color:#E6DB74;">&quot;\`</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"></span>
<span class="line highlighted"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> now </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> audioContext.currentTime;</span></span>
<span class="line highlighted"><span style="color:#88846F;">// create a simple envelop</span></span>
<span class="line highlighted"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> env </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> audioContext.</span><span style="color:#A6E22E;">createGain</span><span style="color:#F8F8F2;">();</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">env.</span><span style="color:#A6E22E;">connect</span><span style="color:#F8F8F2;">(audioContext.destination);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">env.gain.</span><span style="color:#A6E22E;">setValueAtTime</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, now);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">env.gain.</span><span style="color:#A6E22E;">linearRampToValueAtTime</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">0.5</span><span style="color:#F8F8F2;">, now </span><span style="color:#F92672;">+</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">0.01</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">env.gain.</span><span style="color:#A6E22E;">exponentialRampToValueAtTime</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">0.0001</span><span style="color:#F8F8F2;">, now </span><span style="color:#F92672;">+</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"></span>
<span class="line highlighted"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> src </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> audioContext.</span><span style="color:#A6E22E;">createOscillator</span><span style="color:#F8F8F2;">();</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">src.</span><span style="color:#A6E22E;">connect</span><span style="color:#F8F8F2;">(env);</span></span>
<span class="line highlighted"><span style="color:#88846F;">// randomly pick a frequency on an harmonic  spectrum (150, 300, 450, etc...)</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">src.frequency.value </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">150</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">+</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#A6E22E;">floor</span><span style="color:#F8F8F2;">(Math.</span><span style="color:#A6E22E;">random</span><span style="color:#F8F8F2;">() </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">150</span><span style="color:#F8F8F2;">;</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">src.</span><span style="color:#A6E22E;">start</span><span style="color:#F8F8F2;">(now);</span></span>
<span class="line highlighted"><span style="color:#F8F8F2;">src.</span><span style="color:#A6E22E;">stop</span><span style="color:#F8F8F2;">(now </span><span style="color:#F92672;">+</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">);</span></span>
<span class="line highlighted"></span></code></pre></div><p>Reload the page (<code>Cmd+R</code>) and click, you should now ear an incredibly &quot;nice&quot; sound coming from your speakers!</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Note that if you launch multiple clients in the same window (i.e. <a href="http://127.0.0.1:8000/?emulate=4" target="_blank" rel="noreferrer">http://127.0.0.1:8000/?emulate=4</a>), you should see how the init view component also helps you to start all the clients at once without requiring you to click on each of them:</p><p><img src="`+i+`" alt="homepage-multiple"></p></div><h2 id="notes-on-the-soundworks-helpers-default-views" tabindex="-1">Notes on the <code>@soundworks/helpers</code> default views <a class="header-anchor" href="#notes-on-the-soundworks-helpers-default-views" aria-hidden="true">#</a></h2><p>The spashscreen (and other init / loading views that we have not seen yet) are not directly provided by the <em>platform-init</em> plugin but rather by the <code>@soundworks/helpers</code> package and more precisely the <code>launcher</code> object included in the default application. Hence, the views are automatically created by the <code>launcher</code> when it registers the <em>soundworks</em> client in the initialization of the application:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#88846F;">// src/clients/player.index.js</span></span>
<span class="line"><span style="color:#F8F8F2;">launcher.</span><span style="color:#A6E22E;">register</span><span style="color:#F8F8F2;">(client, { initScreensContainer: $container });</span></span>
<span class="line"></span></code></pre></div><p>The launcher offer numerous way to adapt the initialization views to your needs: e.g. change the default styles, adapt the language, or even use completely user defined views.</p><p>While won&#39;t cover these advanced use-case here (as they will be the subject of a dedicated tutorial), let&#39;s just see here the minimal changes you can make to customize the init view.</p><p>Let&#39;s then open the <code>config/application.json</code> file which should look like this:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#88846F;">// config/application.json</span></span>
<span class="line"><span style="color:#F8F8F2;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">  name: </span><span style="color:#E6DB74;">&#39;plugin-platform-init&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  author: </span><span style="color:#E6DB74;">&#39;&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  clients: {</span></span>
<span class="line"><span style="color:#F8F8F2;">    player: {</span></span>
<span class="line"><span style="color:#F8F8F2;">      target: </span><span style="color:#E6DB74;">&#39;browser&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#F92672;">default</span><span style="color:#F8F8F2;">: </span><span style="color:#AE81FF;">true</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"><span style="color:#F8F8F2;">  },</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>This file has been generated for you by the <em>soundworks</em> wizard, and the <code>clients</code> entry is automatically updated each time you create a new client using the wizard.</p><p>However, the first 2 lines can be safely updated and are used by the <code>launcher</code> to create the splashscreen. Let&#39;s just change the <code>name</code> and <code>author</code> entries to see it in action:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki has-diff"><code><span class="line diff remove"><span style="color:#F8F8F2;">name: &#39;plugin-platform-init&#39;, </span></span>
<span class="line diff add"><span style="color:#F8F8F2;">name: &#39;Hello Plugins&#39;, </span></span>
<span class="line diff remove"><span style="color:#F8F8F2;">author: &#39;&#39;, </span></span>
<span class="line diff add"><span style="color:#F8F8F2;">author: &#39;me &amp; myself&#39;, </span></span>
<span class="line"><span style="color:#F8F8F2;"></span></span></code></pre></div><p>And tada! If you now go to <a href="http://127.0.0.1:8000" target="_blank" rel="noreferrer">http://127.0.0.1:8000</a> you should now see something like:</p><p><img src="`+r+'" alt="homepage-custom"></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>By default, the init views try to adapt to the locale of the browser (if the language has not been explicitely defined) and falls back to english if the localized texts are not existing. However, as we only provide english and french versions of the texts for now, it&#39;s likely that you have seen the english version.</p><p>If you are confortable with another language and are willing to contribute a localized version of <a href="https://github.com/collective-soundworks/soundworks-helpers/blob/main/src/browser/i18n/en.js" target="_blank" rel="noreferrer">this file</a>, please open PR or issue in the <a href="https://github.com/collective-soundworks/soundworks-helpers/" target="_blank" rel="noreferrer"><code>@soundworks/helpers</code></a> repository!</p></div><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-hidden="true">#</a></h2><p>In this tutorial, you have learned the basics of <em>soundworks</em> plugins usage, and more precisely how to use the <em>platform-init</em> plugin. While this plugin is not <em>per se</em> very complex, it can save you a lot of (quite boring) development time by simplifying the initialization of certains browser features. Along the way, you also discovered the view functionalities provided by the <code>launcher</code> component that is automatically included in all <em>soundworks</em> applications created using the wizard.</p><p>In the next tutorial, we will wrap up what we have learned so far by creating a small working application where several clients can connect and be used as distributed speakers by a central controller.</p>',72),h=[d];function F(u,g,y,m,f,w){return n(),e("div",null,h)}const b=s(c,[["render",F]]);export{k as __pageData,b as default};
